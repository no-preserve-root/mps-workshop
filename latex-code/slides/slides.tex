% arara: lualatex: { shell : yes }
% arara: lualatex: { shell : yes }
% arara: biber
% arara: lualatex: { shell : yes }
% arara: lualatex: { shell : yes }
% !TeX document-id = {d42c9162-1096-4f40-8a62-8cb41704ea7c}
% !TeX spellcheck = en_US
% !TeX TXS-program:compile = txs:///lualatex/[--shell-escape]
% !BIB program = biber

\input{header}

% Document content
\begin{document}
    \begin{frame}
        \setcounter{framenumber}{0}
        \titlepage
    \end{frame}

    \begin{frame}
        \frametitle{\contentsname}
        \tableofcontents[hideothersubsections]
    \end{frame}

    \section{Introduction}
    
    \begin{frame}{Meta Programming System}
    	The \textbf{Meta Programming System} (MPS) \footnote{\url{https://www.jetbrains.com/mps/}} is a language workbench to create \textbf{Domain Specific Languages} (DSL).\\
    	
    	MPS uses/provides:
    	\begin{itemize}
    		\item Code storage in an \textbf{Abstract Syntax Tree} (AST)
    		\item Projectional editing
    		\item Code generation
    		\item Language extension possibilities
    	\end{itemize}
    \end{frame}

	\begin{frame}
		DSl Landschaft beschreiben (Grafik auf VuC) -> Basis auf AST ohne Parser
	\end{frame}

	\begin{frame}{Abstract Syntax Tree}
		MPS is using an AST as its underlying model, therefore no specific parser is necessary.\\
		
		The language definition is based on AST-nodes, which build the abstract syntax tree.
		\begin{center}
			\includegraphics[height=0.7\textheight]{tikz/ast.pdf}
		\end{center}
	\end{frame}

	\begin{frame}{Projectional Editing}
		The \textbf{Projectional Editor} of MPS is a visual representation of the current AST. It is possible to have multiple editors with different presentation aspects.
		\begin{center}
			\includegraphics[height=0.7\textheight]{tikz/editors.pdf}
		\end{center}
	\end{frame}

	\section{Language Design}
	
	\begin{frame}{\includegraphics[height=0.25cm]{graphics/concept.png}  Structure\footnote{\url{https://www.jetbrains.com/help/mps/structure.html}}}
		The structure of a language is defined as a \textbf{Concept} in MPS\\
		\begin{minipage}{0.52\textwidth}
			Concept:
			\begin{itemize}
				\item Inheritance
				\item Implementation of Interface
				\item Properties:
				\begin{itemize}
					\item Enumeration
					\item Primitive Datatype
					\item Constrained Datatype
				\end{itemize}
				\item Children:
				\begin{itemize}
					\item Any concept 
					\item Multiplicities ([1], [1..n], [0..n], [0..1])
				\end{itemize}
				\item References:
				\begin{itemize}
					\item Reference to another node
				\end{itemize}
			\end{itemize}
		\end{minipage}
		\begin{minipage}{0.4\textwidth}
			\includegraphics[height=0.8\textheight]{illustrations/concept.png}
		\end{minipage}
	\end{frame}

	\section{Language Editor}

	\begin{frame}{\includegraphics[height=0.25cm]{graphics/editor.png}  Editor\footnote{\url{https://www.jetbrains.com/help/mps/editor.html}}}
		\begin{minipage}{0.52\textwidth}
			Types of Cell Models:
			\begin{itemize}
				\item \textbf{Constant cell}: \texttt{<constant>}
				\item \textbf{Property cell}: \texttt{\{property\}}
				\item \textbf{Child cell}: \texttt{\%child\%}
				\item \textbf{Referent cell}: \texttt{(\%reference\%->\{name\})}
				\item \textbf{Child list cell}: \texttt{(>\%child\%/empty cell: <default><)}
				\item \textbf{Model access}: \texttt{*model access*}
				\item \textbf{Collection cell}: \texttt{[- -]} (indent layout) or \\
				\textcolor{white}{Collection cell: n} \texttt{[> <]} (horizontal) or \\
				\textcolor{white}{Collection cell: n} \texttt{[/ /]} (vertical) 
			\end{itemize}
		\end{minipage}
		\begin{minipage}{0.4\textwidth}
			\includegraphics[height=0.8\textheight]{illustrations/editor.png}
		\end{minipage}
	\end{frame}

	\begin{frame}{\includegraphics[height=0.25cm]{graphics/intentions.png} Intentions\footnote{\url{https://www.jetbrains.com/help/mps/mps-intentions.html}}}
		\begin{minipage}{0.52\textwidth}
			Intentions:
			\begin{itemize}
				\item Provide \menu{\workshopintention} menu by pressing \menu{Alt}+\menu{\return}
				\item Execute predefined actions
				\item Can be used to correct errors (\textbf{error intention})
			\end{itemize}
			Variants:
			\begin{itemize}
				\item Intention
				\item Universal Intention
				\item Surround With Intention
				\item Parameterized Intention
			\end{itemize}
		\end{minipage}
		\begin{minipage}{0.4\textwidth}
			\includegraphics[height=0.8\textheight]{illustrations/intention.png}
		\end{minipage}
	\end{frame}

	\begin{frame}{\includegraphics[height=0.25cm]{graphics/checkingrules.png} Checking Rules\footnote{\url{https://www.jetbrains.com/help/mps/typesystem.html}}}
		\begin{minipage}{0.52\textwidth}
			Checks:
			\begin{itemize}
				\item Inspect the model for known error patterns
				\item Static code analysis
				\item Reports found errors/warnings/infos
				\item Can provide quick fixes for errors/warnings
			\end{itemize}
		\end{minipage}
		\begin{minipage}{0.4\textwidth}
			\includegraphics[height=0.8\textheight]{illustrations/check.png}
		\end{minipage}
	\end{frame}

	\begin{frame}{\includegraphics[height=0.25cm]{graphics/quickfix.png} Quick Fixes\footnote{\url{https://www.jetbrains.com/help/mps/typesystem.html}}}
		\begin{minipage}{0.52\textwidth}
			Quick Fixes can be attached to the \texttt{error}, \texttt{warning}\\
			or \texttt{info} call in a checking rule via the \\
			\menu{\workshopinspector{}} menu
		\end{minipage}
		\begin{minipage}{0.4\textwidth}
			\includegraphics[height=0.8\textheight]{illustrations/quickfix.png}
		\end{minipage}
	\end{frame}

	\begin{frame}{\includegraphics[height=0.25cm]{graphics/transformation.png} Transformations\footnote{\url{https://www.jetbrains.com/help/mps/transformation-menu-language.html}}}
		\begin{minipage}{0.52\textwidth}
			Transformations let you edit the AST by replacing \\
			and moving AST nodes\\
			
			\textbf{Example:}\\
			\texttt{(x and y)} type \menu{or} should yield \\
			\texttt{((x and y) or \_)}\\
			\includegraphics[height=0.4\textheight]{tikz/transformation.pdf}
		\end{minipage}
		\begin{minipage}{0.4\textwidth}
			\includegraphics[height=0.75\textheight]{illustrations/transformation.png}
		\end{minipage}
	\end{frame}

	\section{Language Generation}
	
	\begin{frame}{Language Generation}
		In MPS there are two possible ways of generating (here: transforming) code.\\
		
		\begin{minipage}{0.4\textwidth}
			\textbf{Model-To-Model Transformation}
		\end{minipage} 
		\begin{minipage}{0.09\textwidth}
			\Large
			\textcolor{white}{$\Rightarrow$}
		\end{minipage}
		\begin{minipage}{0.4\textwidth}
			\textbf{Model-To-Text Transformation}
		\end{minipage}
	
		\vspace*{0.5cm}
		
		\begin{minipage}{0.4\textwidth}
			\begin{itemize}
				\item Translate models into other models
				\item Predefined models exist:
				\begin{itemize}
					\item Base Language (Java)
					\item mbeddr (C and C extensions) \footnotemark[8]
					\item MPS CSharp (C\#) \footnotemark[9]
				\end{itemize}
				\item Does not flush text into file
				\item Each predefined model has an associated Model-To-Text Transformation
			\end{itemize}
		\end{minipage} 
		\footnotetext[8]{\url{http://mbeddr.com/}}
		\footnotetext[9]{\url{https://github.com/vaclav/MPS_CSharp}}
		\begin{minipage}{0.09\textwidth}
			\Large
			$\Rightarrow$
		\end{minipage}
		\begin{minipage}{0.4\textwidth}
			\begin{itemize}
				\item Convert a model into text
				\item Give the output some reasonable layout
				\item Lets you define a file ending (e.g. \texttt{.java})
				\item Flush text into a file
			\end{itemize}
		\end{minipage}
	\end{frame}

	\begin{frame}{Model-To-Model Transformation \footnote[10]{\url{https://www.jetbrains.com/help/mps/generator-language.html}}}
		\begin{minipage}{0.52\textwidth}
			Each generator consists of \textbf{\workshopconfiguration s} that combines all templates\\
			
			Some Generator Rules:\\
			\begin{itemize}
				\item \textbf{Root Mapping Rule:} Generates a root node in the output model
				\item \textbf{Reduction Rule:} Transforms a node based on a template
				\item \textbf{Mapping Label:} Helper for name consistency throughout generation
			\end{itemize}
		\end{minipage}
		\begin{minipage}{0.4\textwidth}
			\includegraphics[height=0.75\textheight]{illustrations/mapping.png}
		\end{minipage}
	\end{frame}

	\begin{frame}{\workshoptemplate s \footnote[11]{\url{https://www.jetbrains.com/help/mps/generator-language.html}}}
		\begin{minipage}{0.52\textwidth}			
			Template Macros used in a \textbf{Template Fragment <TF TF>}:\\
			\begin{itemize}
				\item \textbf{Property \$[]:} Computes value of a property
				\item \textbf{Reference ->\$[]:} Computes referent node
				\item \textbf{\$IF\$[]:} Conditional generation of template code
				\item \textbf{\$LOOP\$[]:} Applies template to set of nodes
				\item \textbf{\$CALL\$[]:} Calls another template with parameters
				\item \textbf{\$COPY\_SRC\$[]:} Copies node
				\item \textbf{\$LABEL\$[]:} Registers generated name into generation context
			\end{itemize}
		\end{minipage}
		\begin{minipage}{0.4\textwidth}
			\includegraphics[height=0.5\textheight]{illustrations/template.png}
			\includegraphics[height=0.38\textheight]{illustrations/template_inspector.png}
		\end{minipage}
	\end{frame}

	\begin{frame}{\workshoptemplate\ Combination 1/4}
	\begin{minipage}{0.52\textwidth}
		Now the \texttt{MethodDef} concept is contained in a \texttt{ClassDef}
	\end{minipage}
	\begin{minipage}{0.4\textwidth}
		\includegraphics[height=0.8\textheight]{illustrations/classDef.png}
	\end{minipage}
	\end{frame}

	\begin{frame}{\workshoptemplate\ Combination 2/4}
	\begin{minipage}{0.52\textwidth}
		The \texttt{ClassDef} generator template contains a statically generated method \texttt{print()}\\
		
		The \texttt{ClassDef} generator template contains the generated output of the \texttt{MethodDef} concept
	\end{minipage}
	\begin{minipage}{0.4\textwidth}
		\includegraphics[height=0.8\textheight]{illustrations/classDefGen.png}
	\end{minipage}
	\end{frame}

	\begin{frame}{\workshoptemplate\ Combination 3/4}
	\begin{minipage}{0.52\textwidth}
		To generate the method, generate its children: \\
		\begin{itemize}
			\item \texttt{Variables} (e.g. \texttt{\$COPY\_SRCL\$[String s = "";]})
			\item \texttt{Statements} (e.g. \texttt{\$COPY\_SRCL\$[s = "";]})
		\end{itemize}
	
		\textcolor{white}{m}\\
		
		What is now needed to always call the \texttt{print}-method of the \texttt{ClassDef}-concept generation output? The method is currently not available in this context.
	\end{minipage}
	\begin{minipage}{0.4\textwidth}
		\includegraphics[height=0.8\textheight]{illustrations/methodDefGen.png}
	\end{minipage}
	\end{frame}

	\begin{frame}{\workshoptemplate\ Combination 4/4}
	\begin{minipage}{0.52\textwidth}
		To use the \texttt{print}-method, simulate the surrounding environment necessary for the generation (e.g. the surrounding class with its \texttt{print()}-method)\\
		
		Mark the code that should be generated with the \texttt{Template Fragment} macro
	\end{minipage}
	\begin{minipage}{0.4\textwidth}
		\includegraphics[height=0.8\textheight]{illustrations/methodDefGen2.png}
	\end{minipage}
	\end{frame}

	\begin{frame}{\workshoptextgen\ \footnote{\url{https://www.jetbrains.com/help/mps/textgen.html}}}
	\begin{minipage}{0.52\textwidth}
		The TextGen language operations:\\
		\begin{itemize}
			\item \textbf{append:} append text of the following kind:
			\begin{itemize}
				\item \textbf{\{string value\}:} constant text
				\item \textbf{\textbackslash n:} line break
				\item \textbf{\$list\{node.list\}:} list without separator
				\item \textbf{\$list\{node.list with ,\}:} list with separator ``,''
				\item \textbf{\$\{node.child\}}
			\end{itemize}
			\item \textbf{with indent \{ code \}:} increase indentation level for \texttt{code}
			\item \textbf{indent buffer:} apply indentation for current line
			\item \textbf{increase depth:} increase indentation level
			\item \textbf{decrease depth:} decrease indentation level
		\end{itemize}
	\end{minipage}
	\begin{minipage}{0.4\textwidth}
		\includegraphics[height=0.9\textheight]{illustrations/textgen.png}
	\end{minipage}
	\end{frame}

	
\end{document}

